var GemPuzzle=function(){function t(t){n(),t?b=c(L):(a(),L=c(b)),e()}function e(){i(),o(),d(),l()}function n(){b=[],S=0,x.innerHTML="",m()}function a(){for(var t=0;t<T;t++)b.push(t);b.sort(function(){return CommonGameObj.getRandomNum(0,T)})}function c(t){return t.slice()}function i(t){h=t?t:b.indexOf(0)}function o(){for(var t=document.createDocumentFragment(),e=0;e<T;e++){var n=document.createElement("span");n.innerHTML=b[e],n.className="item",n.setAttribute("data-index",e),e===h&&(n.className="item -empty"),t.appendChild(n)}x.appendChild(t)}function r(t){var e=b.splice(t,1,b[h]);b.splice(h,1,e[0])}function s(){var t,e=!1,n=T-1;for(t=1;t<n;t++){if(!(0===b[n]&&b[t]>b[t-1])){e=!1;break}e=!0}return!!e}function u(t){var e=Math.sqrt(T);return t===h+1||t===h-1||t===h+e||t===h-e}function d(){y.innerHTML=S}function l(){p.innerHTML=g(j)+":"+g(M)}function m(){clearInterval(v),j=0,M=0}function f(){var t=document.createElement("div");t.className="message",t.innerHTML="Congratulations! You have successfully finished the puzzle!",x.appendChild(t),setTimeout(function(){x.removeChild(t)},3e3)}function g(t){return(t<10?"0":"")+t}var h,v,x,p,y,b=[],L=[],T=16,S=0,j=0,M=0;return{init:function(){x=document.querySelector(".js-puzzle-container"),p=document.querySelector(".js-time-counter"),y=document.querySelector(".js-step-counter");var e=document.querySelector(".js-restart-game"),n=document.querySelector(".js-new-game"),a=document.querySelector(".js-puzzle-types");t(),x.addEventListener("click",function(t){var e=t.target,n=parseInt(e.getAttribute("data-index"));u(n)&&(r(n),i(n),S++,1===S&&(v=setInterval(function(){M++,M%60||(M=0,j++),l()},1e3)),x.innerHTML="",o(),d(),s()&&(m(),f()))}),e.addEventListener("click",function(){t(!0)}),n.addEventListener("click",function(){t()}),a.addEventListener("click",function(e){var n=e.target,a=n.classList,c=parseInt(n.getAttribute("data-type"));a.contains("-selected")||(n.parentNode.querySelector(".type.-selected").classList.remove("-selected"),a.add("-selected"),x.classList.remove("-type"+T),x.classList.add("-type"+c),T=c,t())})}}}(),HangMan=function(){function t(t){s(),t||(e(),d()),a(),n(),l()}function e(){var t=S[j][M].total,e=CommonGameObj.getRandomNum(0,t);w=S[j][M].words[e],h=w.length}function n(){for(var t=document.createDocumentFragment(),e=T[j],n=e.length,a=0;a<n;a++){var c=document.createElement("span");c.innerHTML=e[a],c.className="item",c.setAttribute("data-index",a),t.appendChild(c)}p.appendChild(t)}function a(){var t=1;for(H+=w[0];t<h-1;)H+="–",t++;H+=w[h-1],x.innerHTML=H}function c(t){var e=T[j][t],n=i(e);H===w&&f("win"),n||(k.drawBodyPart(P),m(),l()),0===P&&f("loss")}function i(t,e){var n=e?e:0,a=w.indexOf(t,n),c=!1;return a>0&&(c=!0,o(a),i(t,a+1)),c}function o(t){H=H.slice(0,t)+w[t]+H.slice(t+1),x.innerHTML=H}function r(){M===S[j].length-1?M=0:M++}function s(){p.innerHTML=null,x.innerHTML=null,y.innerHTML=null,P=6,H="",k.eraseHuman()}function u(){for(var t="",e=0;e<h;e++)t+=H[e]!==w[e]?'<span class="text-red">'+w[e]+"</span>":w[e];H=t,x.innerHTML=H}function d(){b.innerHTML=S[j][M].category}function l(){L.innerHTML=P,0===P?L.classList.add("text-red"):L.classList.remove("text-red")}function m(){P>0&&(P-=1)}function f(t){y.innerHTML=q[t]}function g(t){j=t}var h,v,x,p,y,b,L,T={lang_ru:["а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я"],lang_en:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},S={},j="lang_ru",M=0,w="",H="",P=6,q={loss:'<span class="text-red">Sorry, but you have not guessed the word!</span><br><span data-action="restart" class="hangman-btn">Restart</span><span data-action="show-word" class="hangman-btn">Show word</span>',win:'<span class="text-green">Congratulations! You guessed the word!</span>'},k={ctx:void 0,6:function(){var t=this;t.ctx.beginPath(),t.ctx.arc(186,80,20,0,2*Math.PI,!0),t.ctx.closePath(),t.ctx.stroke()},5:function(){var t=this;t.ctx.fillRect(186,100,2,70)},4:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(186,120),t.ctx.lineTo(150,95),t.ctx.closePath(),t.ctx.stroke()},3:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(188,120),t.ctx.lineTo(224,95),t.ctx.closePath(),t.ctx.stroke()},2:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(186,170),t.ctx.lineTo(150,195),t.ctx.closePath(),t.ctx.stroke()},1:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(188,170),t.ctx.lineTo(224,195),t.ctx.closePath(),t.ctx.stroke()},eraseHuman:function(){var t=this;t.ctx.clearRect(150,59,90,195)},drawScaffold:function(){var t=this;t.ctx.fillStyle="rgb(0,0,0)",t.ctx.fillRect(70,20,8,200),t.ctx.fillRect(30,220,100,8),t.ctx.fillRect(70,20,120,8),t.ctx.fillRect(182,20,8,40),t.ctx.beginPath(),t.ctx.lineWidth=8,t.ctx.moveTo(75,100),t.ctx.lineTo(130,25),t.ctx.closePath(),t.ctx.stroke()},drawBodyPart:function(t){var e=this;e.ctx&&(e.ctx.fillStyle="rgb(0,0,0)",e.ctx.lineWidth=2,e[t]())},init:function(){var t=this;v.getContext&&(t.ctx=v.getContext("2d"),t.drawScaffold())}};return{init:function(){p=document.querySelector(".js-alphabet-container"),x=document.querySelector(".js-word-container"),y=document.querySelector(".js-message-container"),L=document.querySelector(".js-attempt-container"),b=document.querySelector(".js-hint-container"),v=document.querySelector(".js-hangman-canvas");var e=document.querySelector(".js-new-game-btn"),n=document.querySelector(".js-language-switcher");CommonGameObj.fetchData("json/words.json",{},function(e){S=JSON.parse(e),S&&(k.init(),t())}),p.addEventListener("click",function(t){var e=t.target,n=e.classList,a=parseInt(e.getAttribute("data-index"));!n.contains("-selected")&&P>0&&(e.classList.add("-selected"),c(a))}),e.addEventListener("click",function(e){r(),t()}),n.addEventListener("click",function(e){var n=e.target,a=n.getAttribute("data-lang");g(a),r(),t()}),y.addEventListener("click",function(e){var n=e.target,a=n.getAttribute("data-action");"restart"===a?t(!0):u()})}}}(),CommonGameObj={loadHomePage:function(){var t=this,e={body:"home-page-body",game:"CommonGameObj",init:"initGameSelection"};t.fetchData("pages/home.html",e,t.initLoadedPage)},initLoadedPage:function(t,e){t&&(document.body.innerHTML=t,document.body.className=e.body,e.game&&e.init&&window[e.game][e.init]())},initGameSelection:function(){var t=this;document.querySelector(".js-game-selection").addEventListener("click",function(e){var n=e.target,a="pages/"+n.getAttribute("data-path")+".html",c={body:n.getAttribute("data-body"),game:n.getAttribute("data-game"),init:n.getAttribute("data-init")};t.fetchData(a,c,t.initLoadedPage)})},getRandomNum:function(t,e){return Math.floor(Math.random()*(e-t))+t},fetchData:function(t,e,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var t=a.responseText;n&&n(t,e)}},a.open("GET",t,!0),a.send()}},VideoPoker=function(){return{init:function(){}}}();