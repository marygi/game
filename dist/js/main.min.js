var CommonGameObj={loadHomePage:function(){var t=this,e={body:"home-page-body",game:"CommonGameObj",init:"initGameSelection"};t.fetchData("pages/home.html",e,t.initLoadedPage)},initLoadedPage:function(t,e){t&&(document.body.innerHTML=t,document.body.className=e.body,e.game&&e.init&&window[e.game][e.init]())},initGameSelection:function(){var t=this;document.querySelector(".js-game-selection").addEventListener("click",function(e){var n=e.target,a="pages/"+n.getAttribute("data-path")+".html",r={body:n.getAttribute("data-body"),game:n.getAttribute("data-game"),init:n.getAttribute("data-init")};t.fetchData(a,r,t.initLoadedPage)})},getRandomNum:function(t,e){return Math.floor(Math.random()*(e-t))+t},fetchData:function(t,e,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var t=a.responseText;n&&n(t,e)}},a.open("GET",t,!0),a.send()},changeUrl:function(t){history.pushState({},"",t)}},GemPuzzle=function(){function t(t){n(),t?x=r(y):(a(),y=r(x)),e()}function e(){i(),o(),d(),l()}function n(){x=[],k=0,p.innerHTML="",f()}function a(){for(var t=0;t<T;t++)x.push(t);x.sort(function(){return CommonGameObj.getRandomNum(0,T)})}function r(t){return t.slice()}function i(t){h=t?t:x.indexOf(0)}function o(){for(var t=document.createDocumentFragment(),e=0;e<T;e++){var n=document.createElement("span");n.innerHTML=x[e],n.className="item",n.setAttribute("data-index",e),e===h&&(n.className="item -empty"),t.appendChild(n)}p.appendChild(t)}function c(t){var e=x.splice(t,1,x[h]);x.splice(h,1,e[0])}function s(){var t,e=!1,n=T-1;for(t=1;t<n;t++){if(!(0===x[n]&&x[t]>x[t-1])){e=!1;break}e=!0}return!!e}function u(t){var e=Math.sqrt(T);return t===h+1||t===h-1||t===h+e||t===h-e}function d(){L.innerHTML=k}function l(){b.innerHTML=v(S)+":"+v(j)}function f(){clearInterval(g),S=0,j=0}function m(){var t=document.createElement("div");t.className="message",t.innerHTML="Congratulations! You have successfully finished the puzzle!",p.appendChild(t),setTimeout(function(){p.removeChild(t)},3e3)}function v(t){return(t<10?"0":"")+t}var h,g,p,b,L,x=[],y=[],T=16,k=0,S=0,j=0;return{init:function(){p=document.querySelector(".js-puzzle-container"),b=document.querySelector(".js-time-counter"),L=document.querySelector(".js-step-counter");var e=document.querySelector(".js-restart-game"),n=document.querySelector(".js-new-game"),a=document.querySelector(".js-puzzle-types"),r=document.querySelector(".js-back-home-btn");t(),p.addEventListener("click",function(t){var e=t.target,n=parseInt(e.getAttribute("data-index"));u(n)&&(c(n),i(n),k++,1===k&&(g=setInterval(function(){j++,j%60||(j=0,S++),l()},1e3)),p.innerHTML="",o(),d(),s()&&(f(),m()))}),e.addEventListener("click",function(){t(!0)}),n.addEventListener("click",function(){t()}),a.addEventListener("click",function(e){var n=e.target,a=n.classList,r=parseInt(n.getAttribute("data-type"));a.contains("-selected")||(n.parentNode.querySelector(".type.-selected").classList.remove("-selected"),a.add("-selected"),p.classList.remove("-type"+T),p.classList.add("-type"+r),T=r,t())}),r.addEventListener("click",function(){CommonGameObj.loadHomePage()})}}}(),HangMan=function(){function t(t){s(),t||(e(),d()),a(),n(),l()}function e(){var t=k[S][j].total,e=CommonGameObj.getRandomNum(0,t);H=k[S][j].words[e],h=H.length}function n(){for(var t=document.createDocumentFragment(),e=T[S],n=e.length,a=0;a<n;a++){var r=document.createElement("span");r.innerHTML=e[a],r.className="item",r.setAttribute("data-index",a),t.appendChild(r)}b.appendChild(t)}function a(){var t=1;for(M+=H[0];t<h-1;)M+="–",t++;M+=H[h-1],p.innerHTML=M}function r(t){var e=T[S][t],n=i(e);M===H&&m("win"),n||(C.drawBodyPart(q),f(),l()),0===q&&m("loss")}function i(t,e){var n=e?e:0,a=H.indexOf(t,n),r=!1;return a>0&&(r=!0,o(a),i(t,a+1)),r}function o(t){M=M.slice(0,t)+H[t]+M.slice(t+1),p.innerHTML=M}function c(){j===k[S].length-1?j=0:j++}function s(){b.innerHTML=null,p.innerHTML=null,L.innerHTML=null,q=6,M="",C.eraseHuman()}function u(){for(var t="",e=0;e<h;e++)t+=M[e]!==H[e]?'<span class="text-red">'+H[e]+"</span>":H[e];M=t,p.innerHTML=M}function d(){x.innerHTML=k[S][j].category}function l(){y.innerHTML=q,0===q?y.classList.add("text-red"):y.classList.remove("text-red")}function f(){q>0&&(q-=1)}function m(t){L.innerHTML=w[t]}function v(t){S=t}var h,g,p,b,L,x,y,T={lang_ru:["а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я"],lang_en:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},k={},S="lang_ru",j=0,H="",M="",q=6,w={loss:'<span class="text-red">Sorry, but you have not guessed the word!</span><br><span data-action="restart" class="hangman-btn">Restart</span><span data-action="show-word" class="hangman-btn">Show word</span>',win:'<span class="text-green">Congratulations! You guessed the word!</span>'},C={ctx:void 0,6:function(){var t=this;t.ctx.beginPath(),t.ctx.arc(186,80,20,0,2*Math.PI,!0),t.ctx.closePath(),t.ctx.stroke()},5:function(){var t=this;t.ctx.fillRect(186,100,2,70)},4:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(186,120),t.ctx.lineTo(150,95),t.ctx.closePath(),t.ctx.stroke()},3:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(188,120),t.ctx.lineTo(224,95),t.ctx.closePath(),t.ctx.stroke()},2:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(186,170),t.ctx.lineTo(150,195),t.ctx.closePath(),t.ctx.stroke()},1:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(188,170),t.ctx.lineTo(224,195),t.ctx.closePath(),t.ctx.stroke()},eraseHuman:function(){var t=this;t.ctx.clearRect(150,59,90,195)},drawScaffold:function(){var t=this;t.ctx.fillStyle="rgb(0,0,0)",t.ctx.fillRect(70,20,8,200),t.ctx.fillRect(30,220,100,8),t.ctx.fillRect(70,20,120,8),t.ctx.fillRect(182,20,8,40),t.ctx.beginPath(),t.ctx.lineWidth=8,t.ctx.moveTo(75,100),t.ctx.lineTo(130,25),t.ctx.closePath(),t.ctx.stroke()},drawBodyPart:function(t){var e=this;e.ctx&&(e.ctx.fillStyle="rgb(0,0,0)",e.ctx.lineWidth=2,e[t]())},init:function(){var t=this;g.getContext&&(t.ctx=g.getContext("2d"),t.drawScaffold())}};return{init:function(){b=document.querySelector(".js-alphabet-container"),p=document.querySelector(".js-word-container"),L=document.querySelector(".js-message-container"),y=document.querySelector(".js-attempt-container"),x=document.querySelector(".js-hint-container"),g=document.querySelector(".js-hangman-canvas");var e=document.querySelector(".js-new-game-btn"),n=document.querySelector(".js-language-switcher"),a=document.querySelector(".js-back-home-btn");CommonGameObj.fetchData("json/words.json",{},function(e){k=JSON.parse(e),C.init(),t()}),b.addEventListener("click",function(t){var e=t.target,n=e.classList,a=parseInt(e.getAttribute("data-index"));!n.contains("-selected")&&q>0&&(e.classList.add("-selected"),r(a))}),e.addEventListener("click",function(e){c(),t()}),n.addEventListener("click",function(e){var n=e.target,a=n.getAttribute("data-lang");v(a),c(),t()}),L.addEventListener("click",function(e){var n=e.target,a=n.getAttribute("data-action");"restart"===a?t(!0):u()}),a.addEventListener("click",function(){CommonGameObj.loadHomePage()})}}}(),VideoPoker=function(){function t(){a(),n(),l(),c(),M(),q(),w()}function e(){f(),S(),q(),k(),M()}function n(){for(var t=1;t<=D;t++)F.push(t)}function a(){O=1,P=0,E=100}function r(){I.length?(i(),y(),h(),setTimeout(e,500)):(o(),c())}function i(){if(Y.length)for(var t=0;t<B;t++){var e=Y.indexOf(I[t]);e===-1&&(I[t]=u())}c()}function o(){for(var t=0;t<B;){var e=u();I.push(e),t++}}function c(){if(v(),I.length)I.forEach(function(t){s(t)});else for(var t=0;t<B;)s(),t++}function s(t){var e=document.createElement("img"),n=document.createElement("div");e.setAttribute("src","../dist/images/cards/"+(t?F[t-1]:"back")+".png"),e.classList.add("pic"),t&&n.setAttribute("data-card",t),n.classList.add("video-poker-card"),n.appendChild(e),_.appendChild(n)}function u(){var t=!1;do{var e=CommonGameObj.getRandomNum(0,D),n=e+1;if(I.indexOf(n)===-1)return t=!0,n}while(!t);t=!1}function d(t,e){I.length&&(e?Y=Y.filter(function(e){return t!==e}):Y.push(t))}function l(){var t=document.createDocumentFragment();for(var e in V){var n=document.createElement("div"),a=document.createElement("div"),r=1;for(a.innerHTML=V[e].title,a.classList.add("title"),n.classList.add("combination"),n.appendChild(a);r<=J;){var i=document.createElement("div");i.innerHTML=V[e].rate*r,i.classList.add("win"),n.appendChild(i),r++}t.appendChild(n)}A.appendChild(t)}function f(){if(z.innerHTML=null,U>0){var t=V["_"+U];z.innerHTML=t.title+"!<br> You win "+O*t.rate+"!"}else z.innerHTML=E>0?"Try Again!<br>Your Credit is "+(E-O):'Your Credit is 0!<br><span class="text-underline js-poker-restart">Start again?</span>';z.classList.add("-show"),setTimeout(m,2e3)}function m(){z.classList.remove("-show"),z.innerHTML=null,_.classList.add("translucent")}function v(){_.innerHTML=null,_.classList.remove("translucent")}function h(){I=[],Y=[]}function g(){var t,e=!1,n=B-1;for(t=0;t<n;t++){if(I[t]+1!==I[t+1]){e=!1;break}e=!0}return e}function p(){for(var t=!1,e=1,n=[];e<=4;)n.push(W*e),e++;return n.indexOf(I[B-1])>-1&&(t=!0),t}function b(){var t,e=!1,n=T(I[B-1]),a=n-K;for(t=0;t<B;t++){if(!(I[t]>a&&I[t]<=n)){e=!1;break}e=!0}return e}function L(){var t,e=!1,n=B-1;for(t=0;t<n;t++){for(var a=0,r=[],i=I[t]+1;a<4;){var o=i%K+K*a;r.push(o),a++}if(!(r.indexOf(i)>-1)){e=!1;break}e=!0}return e}function x(){var t,e=0,n=B-1;for(t=0;t<n;t++)for(var a=0,r=I[t],i=I.slice(t+1);a<4;){var o=r%K+K*a;i.indexOf(o)>-1&&e++,a++}return e}function y(){I.sort(C);var t=x();1==t?U=1:2==t?U=2:3==t?U=3:4==t?U=6:6==t?U=7:g()?(U=8,p()&&(U=9)):b()?U=5:L()&&(U=4)}function T(t){var e=t+K-1;if(t!==D)for(;e%K;)e--;return e}function k(){U>0?E+=O*V["_"+U].rate:E-=O}function S(){U>0?P+=O*V["_"+U].rate:(P-=O,P<0&&(P=0))}function j(){O=J}function H(){var t=E-O;t<0?O-=t:5===O?O=1:O++}function M(){R.innerHTML=E}function q(){G.innerHTML=P}function w(){N.innerHTML=O,A.setAttribute("data-bet",O)}function C(t,e){return t-e}var E,P,O,A,_,N,G,R,z,F=[],D=52,I=[],Y=[],B=5,K=13,W=13,J=5,U=0,V={_9:{title:"Royal Flush",rate:250},_8:{title:"Straight Flush",rate:40},_7:{title:"Four of a Kind",rate:20},_6:{title:"Full House",rate:9},_5:{title:"Flush",rate:6},_4:{title:"Straight",rate:5},_3:{title:"Three of a Kind",rate:3},_2:{title:"Two Pair",rate:2},_1:{title:"Pair",rate:1}};return{init:function(){A=document.querySelector(".js-poker-combination-table"),_=document.querySelector(".js-poker-cards-container"),N=document.querySelector(".js-poker-bet-container"),G=document.querySelector(".js-poker-win-container"),R=document.querySelector(".js-poker-credit-container"),z=document.querySelector(".js-poker-message-container");var e=!1,n=document.querySelector(".js-poker-bet-btn"),a=document.querySelector(".js-poker-bet-max-btn"),i=document.querySelector(".js-poker-deal-btn"),o=document.querySelector(".js-back-home-btn");t(),i.addEventListener("click",function(){e||(r(),e=!0,setTimeout(function(){e=!1},1e3))}),n.addEventListener("click",function(){I.length||(H(),w())}),a.addEventListener("click",function(){I.length||(j(),w())}),_.addEventListener("click",function(t){var e=t.target,n=e.parentNode,a=parseInt(n.getAttribute("data-card"));I.length&&!isNaN(a)&&(n.classList.contains("-held")?(d(a,!0),n.classList.remove("-held")):(d(a),n.classList.add("-held")))}),o.addEventListener("click",function(){CommonGameObj.loadHomePage()})}}}();