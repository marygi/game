var CommonGameObj={loadHomePage:function(){var t=this,e={body:"home-page-body",game:"CommonGameObj",init:"initGameSelection"};t.fetchData("pages/home.html",e,t.initLoadedPage)},initLoadedPage:function(t,e){t&&(document.body.innerHTML=t,document.body.className=e.body,e.game&&e.init&&window[e.game][e.init]())},initGameSelection:function(){var t=this;document.querySelector(".js-game-selection").addEventListener("click",function(e){var n=e.target,r="pages/"+n.getAttribute("data-path")+".html",a={body:n.getAttribute("data-body"),game:n.getAttribute("data-game"),init:n.getAttribute("data-init")};t.fetchData(r,a,t.initLoadedPage)})},getRandomNum:function(t,e){return Math.floor(Math.random()*(e-t))+t},fetchData:function(t,e,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var t=r.responseText;n&&n(t,e)}},r.open("GET",t,!0),r.send()},changeUrl:function(t){history.pushState({},"",t)}},GemPuzzle=function(){function t(t){n(),t?x=a(y):(r(),y=a(x)),e()}function e(){i(),o(),d(),l()}function n(){x=[],k=0,p.innerHTML="",f()}function r(){for(var t=0;t<T;t++)x.push(t);x.sort(function(){return CommonGameObj.getRandomNum(0,T)})}function a(t){return t.slice()}function i(t){h=t?t:x.indexOf(0)}function o(){for(var t=document.createDocumentFragment(),e=0;e<T;e++){var n=document.createElement("span");n.innerHTML=x[e],n.className="item",n.setAttribute("data-index",e),e===h&&(n.className="item -empty"),t.appendChild(n)}p.appendChild(t)}function c(t){var e=x.splice(t,1,x[h]);x.splice(h,1,e[0])}function s(){var t,e=!1,n=T-1;for(t=1;t<n;t++){if(!(0===x[n]&&x[t]>x[t-1])){e=!1;break}e=!0}return!!e}function u(t){var e=Math.sqrt(T);return t===h+1||t===h-1||t===h+e||t===h-e}function d(){L.innerHTML=k}function l(){b.innerHTML=v(S)+":"+v(j)}function f(){clearInterval(g),S=0,j=0}function m(){var t=document.createElement("div");t.className="message",t.innerHTML="Congratulations! You have successfully finished the puzzle!",p.appendChild(t),setTimeout(function(){p.removeChild(t)},3e3)}function v(t){return(t<10?"0":"")+t}var h,g,p,b,L,x=[],y=[],T=16,k=0,S=0,j=0;return{init:function(){p=document.querySelector(".js-puzzle-container"),b=document.querySelector(".js-time-counter"),L=document.querySelector(".js-step-counter");var e=document.querySelector(".js-restart-game"),n=document.querySelector(".js-new-game"),r=document.querySelector(".js-puzzle-types"),a=document.querySelector(".js-back-home-btn");t(),p.addEventListener("click",function(t){var e=t.target,n=parseInt(e.getAttribute("data-index"));u(n)&&(c(n),i(n),k++,1===k&&(g=setInterval(function(){j++,j%60||(j=0,S++),l()},1e3)),p.innerHTML="",o(),d(),s()&&(f(),m()))}),e.addEventListener("click",function(){t(!0)}),n.addEventListener("click",function(){t()}),r.addEventListener("click",function(e){var n=e.target,r=n.classList,a=parseInt(n.getAttribute("data-type"));r.contains("-selected")||(n.parentNode.querySelector(".type.-selected").classList.remove("-selected"),r.add("-selected"),p.classList.remove("-type"+T),p.classList.add("-type"+a),T=a,t())}),a.addEventListener("click",function(){CommonGameObj.loadHomePage()})}}}(),HangMan=function(){function t(t){s(),t||(e(),d()),r(),n(),l()}function e(){var t=k[S][j].total,e=CommonGameObj.getRandomNum(0,t);H=k[S][j].words[e],h=H.length}function n(){for(var t=document.createDocumentFragment(),e=T[S],n=e.length,r=0;r<n;r++){var a=document.createElement("span");a.innerHTML=e[r],a.className="item",a.setAttribute("data-index",r),t.appendChild(a)}b.appendChild(t)}function r(){var t=1;for(M+=H[0];t<h-1;)M+="–",t++;M+=H[h-1],p.innerHTML=M}function a(t){var e=T[S][t],n=i(e);M===H&&m("win"),n||(C.drawBodyPart(q),f(),l()),0===q&&m("loss")}function i(t,e){var n=e?e:0,r=H.indexOf(t,n),a=!1;return r>0&&(a=!0,o(r),i(t,r+1)),a}function o(t){M=M.slice(0,t)+H[t]+M.slice(t+1),p.innerHTML=M}function c(){j===k[S].length-1?j=0:j++}function s(){b.innerHTML=null,p.innerHTML=null,L.innerHTML=null,q=6,M="",C.eraseHuman()}function u(){for(var t="",e=0;e<h;e++)t+=M[e]!==H[e]?'<span class="text-red">'+H[e]+"</span>":H[e];M=t,p.innerHTML=M}function d(){x.innerHTML=k[S][j].category}function l(){y.innerHTML=q,0===q?y.classList.add("text-red"):y.classList.remove("text-red")}function f(){q>0&&(q-=1)}function m(t){L.innerHTML=w[t]}function v(t){S=t}var h,g,p,b,L,x,y,T={lang_ru:["а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я"],lang_en:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},k={},S="lang_ru",j=0,H="",M="",q=6,w={loss:'<span class="text-red">Sorry, but you have not guessed the word!</span><br><span data-action="restart" class="hangman-btn">Restart</span><span data-action="show-word" class="hangman-btn">Show word</span>',win:'<span class="text-green">Congratulations! You guessed the word!</span>'},C={ctx:void 0,6:function(){var t=this;t.ctx.beginPath(),t.ctx.arc(186,80,20,0,2*Math.PI,!0),t.ctx.closePath(),t.ctx.stroke()},5:function(){var t=this;t.ctx.fillRect(186,100,2,70)},4:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(186,120),t.ctx.lineTo(150,95),t.ctx.closePath(),t.ctx.stroke()},3:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(188,120),t.ctx.lineTo(224,95),t.ctx.closePath(),t.ctx.stroke()},2:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(186,170),t.ctx.lineTo(150,195),t.ctx.closePath(),t.ctx.stroke()},1:function(){var t=this;t.ctx.beginPath(),t.ctx.moveTo(188,170),t.ctx.lineTo(224,195),t.ctx.closePath(),t.ctx.stroke()},eraseHuman:function(){var t=this;t.ctx.clearRect(150,59,90,195)},drawScaffold:function(){var t=this;t.ctx.fillStyle="rgb(0,0,0)",t.ctx.fillRect(70,20,8,200),t.ctx.fillRect(30,220,100,8),t.ctx.fillRect(70,20,120,8),t.ctx.fillRect(182,20,8,40),t.ctx.beginPath(),t.ctx.lineWidth=8,t.ctx.moveTo(75,100),t.ctx.lineTo(130,25),t.ctx.closePath(),t.ctx.stroke()},drawBodyPart:function(t){var e=this;e.ctx&&(e.ctx.fillStyle="rgb(0,0,0)",e.ctx.lineWidth=2,e[t]())},init:function(){var t=this;g.getContext&&(t.ctx=g.getContext("2d"),t.drawScaffold())}};return{init:function(){b=document.querySelector(".js-alphabet-container"),p=document.querySelector(".js-word-container"),L=document.querySelector(".js-message-container"),y=document.querySelector(".js-attempt-container"),x=document.querySelector(".js-hint-container"),g=document.querySelector(".js-hangman-canvas");var e=document.querySelector(".js-new-game-btn"),n=document.querySelector(".js-language-switcher"),r=document.querySelector(".js-back-home-btn");CommonGameObj.fetchData("json/words.json",{},function(e){k=JSON.parse(e),C.init(),t()}),b.addEventListener("click",function(t){var e=t.target,n=e.classList,r=parseInt(e.getAttribute("data-index"));!n.contains("-selected")&&q>0&&(e.classList.add("-selected"),a(r))}),e.addEventListener("click",function(e){c(),t()}),n.addEventListener("click",function(e){var n=e.target,r=n.getAttribute("data-lang");v(r),c(),t()}),L.addEventListener("click",function(e){var n=e.target,r=n.getAttribute("data-action");"restart"===r?t(!0):u()}),r.addEventListener("click",function(){CommonGameObj.loadHomePage()})}}}(),VideoPoker=function(){function t(){r(),c(),H(),M(),q()}function e(){f(),S(),M(),k(),H()}function n(){for(var t=1;t<=D;t++)z.push(t)}function r(){P=1,E=0,C=100}function a(){F.length?(i(),y(),h(),setTimeout(e,500)):(o(),c())}function i(){if(I.length)for(var t=0;t<Y;t++){var e=I.indexOf(F[t]);e===-1&&(F[t]=u())}c()}function o(){for(var t=0;t<Y;){var e=u();F.push(e),t++}}function c(){if(v(),F.length)F.forEach(function(t){s(t)});else for(var t=0;t<Y;)s(),t++}function s(t){var e=document.createElement("img"),n=document.createElement("div");e.setAttribute("src","../dist/images/cards/"+(t?z[t-1]:"back")+".png"),e.classList.add("pic"),t&&n.setAttribute("data-card",t),n.classList.add("video-poker-card"),n.appendChild(e),O.appendChild(n)}function u(){var t=!1;do{var e=CommonGameObj.getRandomNum(0,D),n=e+1;if(F.indexOf(n)===-1)return t=!0,n}while(!t);t=!1}function d(t,e){F.length&&(e?I=I.filter(function(e){return t!==e}):I.push(t))}function l(){var t=document.createDocumentFragment();for(var e in U){var n=document.createElement("div"),r=document.createElement("div"),a=1;for(r.innerHTML=U[e].title,r.classList.add("title"),n.classList.add("combination"),n.appendChild(r);a<=W;){var i=document.createElement("div");i.innerHTML=U[e].rate*a,i.classList.add("win"),n.appendChild(i),a++}t.appendChild(n)}A.appendChild(t)}function f(){if(R.innerHTML=null,J>0){var t=U["_"+J];R.innerHTML=t.title+"!<br> You win "+P*t.rate+"!"}else{var e=C-P;R.innerHTML=0===e?"Your Credit is 0!<br>Press DEAL to restart game!":"Try Again!<br>Your Credit is "+e}R.classList.add("-show"),setTimeout(m,2e3)}function m(){R.classList.remove("-show"),R.innerHTML=null,O.classList.add("translucent")}function v(){O.innerHTML=null,O.classList.remove("translucent")}function h(){F=[],I=[]}function g(){var t,e=!1,n=Y-1;for(t=0;t<n;t++){if(F[t]+1!==F[t+1]){e=!1;break}e=!0}return e}function p(){for(var t=!1,e=1,n=[];e<=4;)n.push(K*e),e++;return n.indexOf(F[Y-1])>-1&&(t=!0),t}function b(){var t,e=!1,n=T(F[Y-1]),r=n-B;for(t=0;t<Y;t++){if(!(F[t]>r&&F[t]<=n)){e=!1;break}e=!0}return e}function L(){var t,e=!1,n=[],r=Y-1;for(t=0;t<Y;t++){var a=F[t]%B;0===a&&(a=K),n.push(a)}for(n.sort(w),t=0;t<r;t++){if(n[t]+1!==n[t+1]){e=!1;break}e=!0}return e}function x(){var t,e=0,n=Y-1;for(t=0;t<n;t++)for(var r=0,a=F[t],i=F.slice(t+1);r<4;){var o=a%B+B*r;i.indexOf(o)>-1&&e++,r++}return e}function y(){F.sort(w);var t=x();1==t?J=1:2==t?J=2:3==t?J=3:4==t?J=6:6==t?J=7:g()?(J=8,p()&&(J=9)):b()?J=5:L()&&(J=4)}function T(t){for(var e=t+B-1;e%B;)e--;return e}function k(){J>0?C+=P*U["_"+J].rate:C-=P}function S(){J>0?E+=P*U["_"+J].rate:(E-=P,E<0&&(E=0))}function j(t){t?P=W:P!==W||t?P++:P=1;var e=C-P;e<0&&(P+=e)}function H(){G.innerHTML=C}function M(){N.innerHTML=E}function q(){_.innerHTML=P,A.setAttribute("data-bet",P)}function w(t,e){return t-e}var C,E,P,A,O,_,N,G,R,z=[],D=52,F=[],I=[],Y=5,B=13,K=13,W=5,J=0,U={_9:{title:"Royal Flush",rate:250},_8:{title:"Straight Flush",rate:40},_7:{title:"Four of a Kind",rate:20},_6:{title:"Full House",rate:9},_5:{title:"Flush",rate:6},_4:{title:"Straight",rate:5},_3:{title:"Three of a Kind",rate:3},_2:{title:"Two Pair",rate:2},_1:{title:"Pair",rate:1}};return{init:function(){A=document.querySelector(".js-poker-combination-table"),O=document.querySelector(".js-poker-cards-container"),_=document.querySelector(".js-poker-bet-container"),N=document.querySelector(".js-poker-win-container"),G=document.querySelector(".js-poker-credit-container"),R=document.querySelector(".js-poker-message-container");var e=!1,r=document.querySelector(".js-poker-bet-btn"),i=document.querySelector(".js-poker-bet-max-btn"),o=document.querySelector(".js-poker-deal-btn"),c=document.querySelector(".js-back-home-btn");n(),l(),t(),o.addEventListener("click",function(){e||(0===C?t():a(),e=!0,setTimeout(function(){e=!1},800))}),r.addEventListener("click",function(){F.length||(j(),q())}),i.addEventListener("click",function(){F.length||(j(!0),q())}),O.addEventListener("click",function(t){var e=t.target,n=e.parentNode,r=parseInt(n.getAttribute("data-card"));F.length&&!isNaN(r)&&(n.classList.contains("-held")?(d(r,!0),n.classList.remove("-held")):(d(r),n.classList.add("-held")))}),c.addEventListener("click",function(){CommonGameObj.loadHomePage()})}}}();